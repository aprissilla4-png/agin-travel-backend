const express = require('express');
const cors = require('cors'); // 1. Impor paket cors
const app = express();

export default function handler(request, response) {
    
    response.setHeader('Access-Control-Allow-Origin', '*');
    response.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS');
    response.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');

    if (request.method === 'OPTIONS') {
        return response.status(200).end();
    }

    const contacts = [
        { id: 1, name: "Kontak Contoh", lastMessage: "Halo!" }
    ];
    
    return response.status(200).json(contacts);
}

// 2. Gunakan middleware cors SEBELUM rute API Anda
// Opsi paling sederhana (mengizinkan semua origin):
app.use(cors());

/*
// Opsi yang lebih aman untuk production (hanya izinkan domain frontend Anda)
const corsOptions = {
  origin: 'http://localhost:8080' // atau 'https://domain-frontend-anda.com'
};
app.use(cors(corsOptions));
*/


app.use(express.json());

// ... (kode rute Anda, contoh: app.post('/api/chat', ...)) ...

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
